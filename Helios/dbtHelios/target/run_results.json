{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-04-02T14:55:51.331433Z", "invocation_id": "ca9dd2cd-b553-4252-bbc7-f656346eecd8", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:49.554245Z", "completed_at": "2025-04-02T14:55:49.565947Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:49.566954Z", "completed_at": "2025-04-02T14:55:49.625042Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0717315673828125, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__sa_insern", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"duckdb_database\".\"main\".\"sa_insern\"", "relation_name": "\"duckdb_database\".\"main\".\"staging__sa_insern\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:49.630195Z", "completed_at": "2025-04-02T14:55:49.640303Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:49.640303Z", "completed_at": "2025-04-02T14:55:49.665875Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.035680532455444336, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__sa_siicea_cibles", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"duckdb_database\".\"main\".\"sa_siicea_cibles\"", "relation_name": "\"duckdb_database\".\"main\".\"staging__sa_siicea_cibles\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:49.667798Z", "completed_at": "2025-04-02T14:55:49.670486Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:49.670486Z", "completed_at": "2025-04-02T14:55:49.694220Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026421546936035156, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__sa_siicea_missions", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"duckdb_database\".\"main\".\"sa_siicea_missions\"", "relation_name": "\"duckdb_database\".\"main\".\"staging__sa_siicea_missions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:49.698174Z", "completed_at": "2025-04-02T14:55:49.703878Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:49.703878Z", "completed_at": "2025-04-02T14:55:49.722072Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024796724319458008, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__sa_siicea_suites", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"duckdb_database\".\"main\".\"sa_siicea_suites\"", "relation_name": "\"duckdb_database\".\"main\".\"staging__sa_siicea_suites\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:49.731116Z", "completed_at": "2025-04-02T14:55:49.736123Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:49.737124Z", "completed_at": "2025-04-02T14:55:49.753393Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023285388946533203, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__sa_sirec", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"duckdb_database\".\"main\".\"sa_sirec\"", "relation_name": "\"duckdb_database\".\"main\".\"staging__sa_sirec\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:49.762298Z", "completed_at": "2025-04-02T14:55:49.765297Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:49.765976Z", "completed_at": "2025-04-02T14:55:49.784402Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023111581802368164, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__sa_sivss", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"duckdb_database\".\"main\".\"sa_sivss\"", "relation_name": "\"duckdb_database\".\"main\".\"staging__sa_sivss\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:49.788942Z", "completed_at": "2025-04-02T14:55:49.792844Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:49.792844Z", "completed_at": "2025-04-02T14:55:49.813830Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0248873233795166, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__sa_t_finess", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"duckdb_database\".\"main\".\"sa_t_finess\"", "relation_name": "\"duckdb_database\".\"main\".\"staging__sa_t_finess\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:49.820036Z", "completed_at": "2025-04-02T14:55:49.820036Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:49.820036Z", "completed_at": "2025-04-02T14:55:49.843245Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02941584587097168, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__v_comer", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"duckdb_database\".\"main\".\"v_comer\"", "relation_name": "\"duckdb_database\".\"main\".\"staging__v_comer\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:49.848381Z", "completed_at": "2025-04-02T14:55:49.850909Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:49.851895Z", "completed_at": "2025-04-02T14:55:49.870481Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0230865478515625, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__v_commune", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"duckdb_database\".\"main\".\"v_commune\"", "relation_name": "\"duckdb_database\".\"main\".\"staging__v_commune\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:49.875464Z", "completed_at": "2025-04-02T14:55:49.878469Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:49.878469Z", "completed_at": "2025-04-02T14:55:49.898762Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02430891990661621, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__v_commune_comer", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"duckdb_database\".\"main\".\"v_commune_comer\"", "relation_name": "\"duckdb_database\".\"main\".\"staging__v_commune_comer\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:49.902394Z", "completed_at": "2025-04-02T14:55:49.902394Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:49.902394Z", "completed_at": "2025-04-02T14:55:49.974918Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07443094253540039, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__v_commune_depuis", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"duckdb_database\".\"main\".\"v_commune_depuis\"", "relation_name": "\"duckdb_database\".\"main\".\"staging__v_commune_depuis\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:49.980203Z", "completed_at": "2025-04-02T14:55:49.984220Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:49.984220Z", "completed_at": "2025-04-02T14:55:50.000167Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021474599838256836, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__v_departement", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"duckdb_database\".\"main\".\"v_departement\"", "relation_name": "\"duckdb_database\".\"main\".\"staging__v_departement\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:50.008221Z", "completed_at": "2025-04-02T14:55:50.012826Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:50.013447Z", "completed_at": "2025-04-02T14:55:50.030253Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02203226089477539, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__v_region", "compiled": true, "compiled_code": "\n\nSELECT * FROM \"duckdb_database\".\"main\".\"v_region\"", "relation_name": "\"duckdb_database\".\"main\".\"staging__v_region\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:50.035163Z", "completed_at": "2025-04-02T14:55:50.040252Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:50.040252Z", "completed_at": "2025-04-02T14:55:50.061219Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027057170867919922, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__cert_dc_insern", "compiled": true, "compiled_code": "\n\nWITH insern AS (\n    SELECT * FROM \"duckdb_database\".\"main\".\"staging__sa_insern\"\n)\n\nSELECT \n    ROW_NUMBER() OVER () AS index,\n    CAST(Annee || '-' || LPAD(Mois::VARCHAR, 2, '0') || '-' || LPAD(Jour::VARCHAR, 2, '0') AS DATE) AS date_deces,\n    Annee AS annee,\n    Mois AS mois,\n    Jour AS jour,\n    departement_code,\n    commune_code,\n    et_finess,\n    lieu_de_deces,\n    source,\n    1 AS deces_nb\nFROM insern", "relation_name": "\"duckdb_database\".\"main\".\"staging__cert_dc_insern\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:50.067032Z", "completed_at": "2025-04-02T14:55:50.070546Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:50.070546Z", "completed_at": "2025-04-02T14:55:50.092827Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02691030502319336, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__tdb_ic_siicea_cibles", "compiled": true, "compiled_code": "\n\nWITH siicea_cibles AS (\n    SELECT \n        \"FINESS\" AS code_finess,\n        \"RPPSS\" AS code_rppss,\n        \"SIRET\" AS code_siret,\n        \"Code APE\" AS code_ape,\n        \"Code UAI\" AS code_uai,\n        \"Groupe de cibles\" AS groupe_cibles,\n        \"Nom\" AS nom_cible,\n        \"Departement\" AS departement,\n        \"Commune\" AS commune,\n        \"Adresse\" AS adresse,\n        \"Nombre de missions r\u00e9alis\u00e9es \" AS nb_missions_realisees,\n        \"Nombre de missions abondonn\u00e9es / report\u00e9es \" AS nb_missions_abandonnees,\n        \"Nombre de d\u00e9cisions prises\" AS nb_decisions_prises\n    FROM \"duckdb_database\".\"main\".\"staging__sa_siicea_cibles\"\n    \n    WHERE TRIM(\"FINESS\") != ''  -- Exclure les lignes sans code FINESS\n)\n\nSELECT * FROM siicea_cibles", "relation_name": "\"duckdb_database\".\"main\".\"staging__tdb_ic_siicea_cibles\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:50.095662Z", "completed_at": "2025-04-02T14:55:50.102217Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:50.102217Z", "completed_at": "2025-04-02T14:55:50.120021Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02435922622680664, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__helios_siicea_missions", "compiled": true, "compiled_code": "\n\nWITH missions AS (\n    SELECT \n        *,\n        CASE \n            WHEN LENGTH(\"Code FINESS\") = 8 THEN '0' || \"Code FINESS\"\n            ELSE \"Code FINESS\"\n        END AS cd_finess\n    FROM \"duckdb_database\".\"main\".\"staging__sa_siicea_missions\"\n    WHERE \"Code th\u00e8me IGAS\" IN (\n        'MS634D13', 'MS634N1', 'MS634E1', 'MS634D12', 'MS634R1',\n        'MS634D11', 'MS634D15', 'MS634C10'\n    )\n    AND \"Type de mission\" NOT IN (\n        'Audit', 'Audit franco-wallon', 'Evaluation', \n        'Visites de conformit\u00e9', 'Enqu\u00eate administrative'\n    )\n    AND \"Statut de la mission\" IN ('Cl\u00f4tur\u00e9', 'Maintenu')\n    AND (\n        CAST(SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 1, 4) || \n             SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 6, 2) || \n             SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 9, 2) AS INTEGER)\n        BETWEEN 20220101 AND 20241231\n    )\n)\n\nSELECT * FROM missions", "relation_name": "\"duckdb_database\".\"main\".\"staging__helios_siicea_missions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:50.129267Z", "completed_at": "2025-04-02T14:55:50.133898Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:50.134813Z", "completed_at": "2025-04-02T14:55:50.160500Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03224444389343262, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__matrice_siicea_cibles", "compiled": true, "compiled_code": "\n\nWITH cibles AS (\n    SELECT \n        c.*,\n        m.\"Date r\u00e9elle \"\"Visite\"\"\" AS date_reelle_visite,\n        m.\"Statut de la mission\",\n        m.\"Secteur dintervention\",\n        m.\"Type de mission\"\n    FROM \"duckdb_database\".\"main\".\"staging__sa_siicea_cibles\" c\n    LEFT JOIN \"duckdb_database\".\"main\".\"staging__sa_siicea_missions\" m\n        ON c.FINESS = m.\"Code FINESS\"\n),\n\nfiltered_cibles AS (\n    SELECT *\n    FROM cibles\n    WHERE \n        -- Filtre sur la p\u00e9riode (missions entre 2022 et 2024)\n        date_reelle_visite BETWEEN '2022-01-01' AND '2024-12-31'\n        -- Filtre sur les statuts de mission valides\n        AND \"Statut de la mission\" IN ('Cl\u00f4tur\u00e9', 'Maintenu')\n        -- Filtre sur le secteur d\u2019intervention\n        AND \"Secteur dintervention\" IN ('M\u00e9dico-social', 'Sanitaire')\n        -- Exclusion des types de mission non pertinents\n        AND \"Type de mission\" NOT IN (\n            'Audit', 'Audit franco-wallon', \n            'Evaluation', 'Visites de conformit\u00e9', \n            'Enqu\u00eate administrative'\n        )\n)\n\nSELECT * FROM filtered_cibles", "relation_name": "\"duckdb_database\".\"main\".\"staging__matrice_siicea_cibles\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:50.164590Z", "completed_at": "2025-04-02T14:55:50.168614Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:50.168614Z", "completed_at": "2025-04-02T14:55:50.199136Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.036637306213378906, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__matrice_siicea_missions_real", "compiled": true, "compiled_code": "\n\nWITH missions AS (\n    SELECT \n        *\n    FROM \"duckdb_database\".\"main\".\"staging__sa_siicea_missions\"\n    WHERE \n        -- Filtre sur la p\u00e9riode des missions\n        \"Date r\u00e9elle \"\"Visite\"\"\" BETWEEN '2022-01-01' AND '2024-12-31'\n        -- Filtre sur le statut r\u00e9alis\u00e9\n        AND \"Statut de la mission\" IN ('Cl\u00f4tur\u00e9', 'Maintenu')\n        -- Filtre sur le secteur d\u2019intervention\n        AND \"Secteur dintervention\" = 'M\u00e9dico-social'\n        -- Filtre des th\u00e8mes IGAS pertinents\n        AND \"Code th\u00e8me IGAS\" IN (\n            'MS634D13', 'MS634N1', 'MS634E1', \n            'MS634D12', 'MS634R1', 'MS634D11', \n            'MS634D15', 'MS634C10'\n        )\n        -- Filtre sur les types de mission (on exclut les types non pertinents)\n        AND \"Type de mission\" NOT IN (\n            'Audit', 'Audit franco-wallon', \n            'Evaluation', 'Visites de conformit\u00e9', \n            'Enqu\u00eate administrative'\n        )\n)\n\nSELECT * FROM missions", "relation_name": "\"duckdb_database\".\"main\".\"staging__matrice_siicea_missions_real\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:50.202947Z", "completed_at": "2025-04-02T14:55:50.209355Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:50.209864Z", "completed_at": "2025-04-02T14:55:50.239618Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.037188053131103516, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__siicea_input_test", "compiled": true, "compiled_code": "\n\nWITH missions AS (\n    SELECT \n        \"Identifiant de la mission\" AS identifiant_mission,\n        \"Code FINESS\" AS code_finess,\n        \"Date r\u00e9elle \"\"Visite\"\"\" AS date_reelle_visite\n    FROM \"duckdb_database\".\"main\".\"staging__sa_siicea_missions\"\n)\n\nSELECT \n    COUNT(*) AS nombre_de_lignes,\n    COUNT(DISTINCT identifiant_mission) AS nombre_distinct_id_missions,\n    SUM(CASE WHEN LENGTH(code_finess) = 8 THEN 1 ELSE 0 END) AS longueur_ko_finess,\n    SUM(CASE WHEN LENGTH(code_finess) = 9 THEN 1 ELSE 0 END) AS longueur_ok_finess,\n    COUNT(DISTINCT LENGTH(code_finess)) AS nombre_de_longueurs_differentes_finess,\n    MIN(date_reelle_visite) AS date_reelle_visite_plus_ancienne,\n    MAX(date_reelle_visite) AS date_reelle_visite_plus_recente,\n    MIN(SUBSTRING(date_reelle_visite,1,4)) AS annee_min,\n    MIN(SUBSTRING(date_reelle_visite,6,2)) AS mois_min,\n    MAX(SUBSTRING(date_reelle_visite,1,4)) AS annee_max,\n    MAX(SUBSTRING(date_reelle_visite,6,2)) AS mois_max\nFROM missions", "relation_name": "\"duckdb_database\".\"main\".\"staging__siicea_input_test\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:50.246307Z", "completed_at": "2025-04-02T14:55:50.250478Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:50.251082Z", "completed_at": "2025-04-02T14:55:50.279948Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.035434722900390625, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__tdb_ic_siicea_missions_prog", "compiled": true, "compiled_code": "\n\nWITH missions_prog AS (\n    SELECT \n        \"Identifiant de la mission\" AS identifiant_mission,\n        \"Code th\u00e8me IGAS\" AS code_theme_igas,\n        \"Th\u00e8me IGAS\" AS theme_igas,\n        \"Type de mission\" AS type_mission,\n        \"Modalit\u00e9 dinvestigation\" AS modalite_d_investigation,\n        \"Type de planification\" AS type_planification,\n        \"Modalit\u00e9 de la mission\" AS modalite_mission,\n        \"Mission conjointe avec 1\" AS mission_conjointe_1,\n        \"Mission conjointe avec 2\" AS mission_conjointe_2,\n        \"D\u00e9partement\" AS departement,\n        \"Commune\" AS commune,\n        \"Adresse\" AS adresse,\n        \"Groupe de cibles\" AS groupe_cibles,\n        \"Cible\" AS cible,\n        \"Caract\u00e8re juridique\" AS caractere_juridique,\n        \"Type de cible\" AS type_cible,\n        \"Code FINESS\" AS code_finess,\n        \"Statut de la mission\" AS statut_mission,\n\n        -- Formatage des dates\n        CASE\n            WHEN LENGTH(\"Date provisoire \"\"Visite\"\"\") = 10 \n            THEN SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 7, 4) || '-' ||\n                 SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 4, 2) || '-' ||\n                 SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 1, 2) || ' 00:00:00'\n            ELSE \"Date provisoire \"\"Visite\"\"\"\n        END AS date_provisoire_visite,\n\n        CASE\n            WHEN LENGTH(\"Date r\u00e9elle \"\"Visite\"\"\") = 10 \n            THEN SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 7, 4) || '-' ||\n                 SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 4, 2) || '-' ||\n                 SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 1, 2) || ' 00:00:00'\n            ELSE \"Date r\u00e9elle \"\"Visite\"\"\"\n        END AS date_reelle_visite,\n\n        \"Date provisoire \"\"Fin Mission\"\"\" AS date_provisoire_fin_mission,\n        \"Date r\u00e9elle \"\"Fin Mission\"\"\" AS date_reelle_fin_mission,\n\n        -- Ajout du z\u00e9ro devant les codes FINESS de longueur 8\n        CASE \n            WHEN LENGTH(\"Code FINESS\") = 8 THEN '0' || \"Code FINESS\"\n            ELSE \"Code FINESS\"\n        END AS cd_finess\n\n    FROM \"duckdb_database\".\"main\".\"staging__sa_siicea_missions\"\n    \n    WHERE 1=1\n    -- Filtrage sur la p\u00e9riode\n    AND (\n        (\"Date r\u00e9elle \"\"Visite\"\"\" = '' \n            AND (CASE\n                    WHEN LENGTH(\"Date provisoire \"\"Visite\"\"\") = 10 \n                    THEN SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 7, 4) || '-' ||\n                         SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 4, 2) || '-' ||\n                         SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 1, 2) || ' 00:00:00'\n                    ELSE \"Date provisoire \"\"Visite\"\"\"\n                 END) > '2024-12-31 00:00:00') \n        OR (\n            CASE\n                WHEN LENGTH(\"Date r\u00e9elle \"\"Visite\"\"\") = 10 \n                THEN SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 7, 4) || '-' ||\n                     SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 4, 2) || '-' ||\n                     SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 1, 2) || ' 00:00:00'\n                ELSE \"Date r\u00e9elle \"\"Visite\"\"\"\n            END) > '2024-12-31 00:00:00'\n    )\n    \n    -- Exclusion des statuts cl\u00f4tur\u00e9s ou abandonn\u00e9s\n    AND \"Statut de la mission\" NOT IN ('Cl\u00f4tur\u00e9', 'Abandonn\u00e9')\n    \n    --\n    AND \"Secteur dintervention\" = 'M\u00e9dico-social'\n    \n    -- Filtrage sur le type de cible\n    AND \"Type de cible\" = 'Etablissements et Services pour Personnes Ag\u00e9es'\n    \n    -- Filtrage des th\u00e8mes IGAS pertinents\n    AND \"Code th\u00e8me IGAS\" IN (\n        'MS634D13', 'MS634D13', 'MS634N1', 'MS634E1', \n        'MS634D12', 'MS634R1', 'MS634D11', 'MS634D15', \n        'MS634C10', 'MS634C10'\n    )\n    \n    -- Exclusion des types de mission non pertinents\n    AND \"Type de mission\" NOT IN (\n        'Audit', 'Audit franco-wallon', 'Evaluation', \n        'Visites de conformit\u00e9', 'Enqu\u00eate administrative'\n    )\n)\n\nSELECT * FROM missions_prog", "relation_name": "\"duckdb_database\".\"main\".\"staging__tdb_ic_siicea_missions_prog\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:50.285623Z", "completed_at": "2025-04-02T14:55:50.289642Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:50.289642Z", "completed_at": "2025-04-02T14:55:50.319293Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03985786437988281, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__tdb_ic_siicea_missions_real", "compiled": true, "compiled_code": "\n\nWITH missions_real AS (\n    SELECT \n        \"Identifiant de la mission\" AS identifiant_mission,\n        \"Code th\u00e8me IGAS\" AS code_theme_igas,\n        \"Th\u00e8me IGAS\" AS theme_igas,\n        \"Type de mission\" AS type_mission,\n        \"Modalit\u00e9 dinvestigation\" AS modalite_d_investigation,\n        \"Type de planification\" AS type_planification,\n        \"Modalit\u00e9 de la mission\" AS modalite_mission,\n        \"Mission conjointe avec 1\" AS mission_conjointe_1,\n        \"Mission conjointe avec 2\" AS mission_conjointe_2,\n        \"D\u00e9partement\" AS departement,\n        \"Commune\" AS commune,\n        \"Adresse\" AS adresse,\n        \"Groupe de cibles\" AS groupe_cibles,\n        \"Cible\" AS cible,\n        \"Caract\u00e8re juridique\" AS caractere_juridique,\n        \"Type de cible\" AS type_cible,\n        \"Code FINESS\" AS code_finess,\n        \"Statut de la mission\" AS statut_mission,\n\n        -- Formatage des dates\n        CASE\n            WHEN LENGTH(\"Date provisoire \"\"Visite\"\"\") = 10 \n            THEN SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 7, 4) || '-' ||\n                 SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 4, 2) || '-' ||\n                 SUBSTRING(\"Date provisoire \"\"Visite\"\"\", 1, 2) || ' 00:00:00'\n            ELSE \"Date provisoire \"\"Visite\"\"\"\n        END AS date_provisoire_visite,\n\n        CASE\n            WHEN LENGTH(\"Date r\u00e9elle \"\"Visite\"\"\") = 10 \n            THEN SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 7, 4) || '-' ||\n                 SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 4, 2) || '-' ||\n                 SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 1, 2) || ' 00:00:00'\n            ELSE \"Date r\u00e9elle \"\"Visite\"\"\"\n        END AS date_reelle_visite,\n\n        \"Date provisoire \"\"Fin Mission\"\"\" AS date_provisoire_fin_mission,\n        \"Date r\u00e9elle \"\"Fin Mission\"\"\" AS date_reelle_fin_mission,\n\n        -- Ajout du z\u00e9ro devant les codes FINESS de longueur 8\n        CASE \n            WHEN LENGTH(\"Code FINESS\") = 8 THEN '0' || \"Code FINESS\"\n            ELSE \"Code FINESS\"\n        END AS cd_finess\n\n    FROM \"duckdb_database\".\"main\".\"staging__sa_siicea_missions\"\n    \n    WHERE 1=1\n    -- Filtrage sur la p\u00e9riode des missions r\u00e9alis\u00e9es\n    AND (\n        CASE\n            WHEN LENGTH(\"Date r\u00e9elle \"\"Visite\"\"\") = 10 \n            THEN SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 7, 4) || '-' ||\n                 SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 4, 2) || '-' ||\n                 SUBSTRING(\"Date r\u00e9elle \"\"Visite\"\"\", 1, 2) || ' 00:00:00'\n            ELSE \"Date r\u00e9elle \"\"Visite\"\"\"\n        END\n    ) BETWEEN '2022-01-01 00:00:00' AND '2024-12-31 00:00:00'\n    \n    -- Filtrage sur le statut r\u00e9alis\u00e9\n    AND \"Statut de la mission\" IN ('Cl\u00f4tur\u00e9', 'Maintenu')\n    \n    -- Filtrage sur le secteur d'intervention\n    AND \"Secteur dintervention\" = 'M\u00e9dico-social'\n    \n    -- Filtrage sur le type de cible\n    AND \"Type de cible\" = 'Etablissements et Services pour Personnes Ag\u00e9es'\n    \n    -- Filtrage des th\u00e8mes IGAS pertinents\n    AND \"Code th\u00e8me IGAS\" IN (\n        'MS634D13', 'MS634D13', 'MS634N1', 'MS634E1', \n        'MS634D12', 'MS634R1', 'MS634D11', 'MS634D15', \n        'MS634C10', 'MS634C10'\n    )\n    \n    -- Exclusion des types de mission non pertinents\n    AND \"Type de mission\" NOT IN (\n        'Audit', 'Audit franco-wallon', 'Evaluation', \n        'Visites de conformit\u00e9', 'Enqu\u00eate administrative'\n    )\n)\n\nSELECT * FROM missions_real", "relation_name": "\"duckdb_database\".\"main\".\"staging__tdb_ic_siicea_missions_real\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:50.324462Z", "completed_at": "2025-04-02T14:55:50.327461Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:50.328469Z", "completed_at": "2025-04-02T14:55:50.350740Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027287721633911133, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__helios_sirec", "compiled": true, "compiled_code": "\n\nWITH sirec AS (\n    SELECT * FROM \"duckdb_database\".\"main\".\"staging__sa_sirec\"\n    WHERE \"Date de r\u00e9ception \u00e0 l\u2019ARS\" BETWEEN '2022-01-01' AND '2024-12-31'\n)\n\nSELECT * FROM sirec", "relation_name": "\"duckdb_database\".\"main\".\"staging__helios_sirec\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:50.350740Z", "completed_at": "2025-04-02T14:55:50.360064Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:50.360064Z", "completed_at": "2025-04-02T14:55:50.382477Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0317378044128418, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__matrice_sirec", "compiled": true, "compiled_code": "\n\nWITH sirec AS (\n    SELECT * FROM \"duckdb_database\".\"main\".\"staging__sa_sirec\"\n)\n\nSELECT \n    \"Num\u00e9ro de la r\u00e9clamation\" AS numero_reclamation,\n    \"Ancien num\u00e9ro de la r\u00e9clamation\" AS ancien_numero_reclamation,\n    \"Num\u00e9ro D\u00e9mat Social\" AS numero_demat_social,\n    \"Service gestionnaire\" AS service_gestionnaire,\n    \"Statut de la r\u00e9clamation\" AS statut_reclamation,\n    \"Services en lecture\" AS services_en_lecture,\n    Signalement AS signalement,\n    \"Date de la demande du requ\u00e9rant\" AS date_demande_requerant,\n    \"Date de r\u00e9ception \u00e0 l\u2019ARS\" AS date_reception_ars,\n    \"Service de premier niveau\" AS service_premier_niveau,\n    \"Date de r\u00e9ception au service de premier niveau\" AS date_reception_service_premier_niveau,\n    Description AS description,\n    \"Date de cr\u00e9ation de la r\u00e9clamation\" AS date_creation_reclamation,\n    \"Domaine fonctionnel\" AS domaine_fonctionnel,\n    \"Mode de r\u00e9ception\" AS mode_reception,\n    \"Prioritaire : Oui/Non\" AS prioritaire_oui_non,\n    \"Pr\u00e9cisions sur le caract\u00e8re prioritaire\" AS precisions_caractere_prioritaire,\n    \"D\u00e9partement de la r\u00e9clamation\" AS departement_reclamation,\n    \"Destinataire(s) de la r\u00e9clamation\" AS destinataires_reclamation,\n    \"Destinataire primaire\" AS destinataire_primaire,\n    \"Destinataire secondaire\" AS destinataire_secondaire,\n    \"Saisine du procureur par requ\u00e9rant\" AS saisine_procureur_requerant,\n    \"Institutions de provenance\" AS institutions_provenance,\n    \"Date de r\u00e9ception \u00e0 l'institution de provenance\" AS date_reception_institution_provenance,\n    reponse_attendue,\n    \"Courrier signal\u00e9 : Oui/Non\" AS courrier_signale_oui_non,\n    \"Le requ\u00e9rant est\" AS le_requerant_est,\n    \"Le requ\u00e9rant est anonyme\" AS le_requerant_est_anonyme,\n    \"Le requ\u00e9rant souhaite garder l'anonymat\" AS le_requerant_souhaite_garder_anonymat,\n    \"Statut du requ\u00e9rant\" AS statut_requerant,\n    \"Plus de 2 r\u00e9clamations d\u00e9pos\u00e9es\" AS plus_de_2_reclamations_deposees,\n    \"Usager (victime) non identifi\u00e9e\" AS usager_victime_non_identifiee,\n    \"Sans mis en cause\" AS sans_mis_en_cause,\n    CAST(\"N\u00b0 FINESS/RPPS\" AS VARCHAR) AS numero_finess_rpps,  -- \u2705 Conversion ici\n    Autre_Type AS autre_type,\n    \"Nom structure\" AS nom_structure,\n    Adresse AS adresse,\n    \"Code postal\" AS code_postal,\n    Ville AS ville,\n    \"Service pour les \u00e9tablissements sanitaires\" AS service_etablissements_sanitaires,\n    \"Observations du mis en cause\" AS observations_mis_en_cause,\n    \"Motifs IGAS entr\u00e9e\" AS motifs_igas_entree,\n    \"Motifs IGAS sortie\" AS motifs_igas_sortie,\n    \"Niveau de comp\u00e9tence de traitement de la r\u00e9clamation\" AS niveau_competence_traitement_reclamation,\n    \"Institution(s) partenaire(s)\" AS institutions_partenaires,\n    \"Pr\u00e9cisions sur le niveau de comp\u00e9tence de traitement de la r\u00e9clamation\" AS precisions_niveau_competence_traitement_reclamation,\n    \"Envoi d'un accus\u00e9 r\u00e9ception\" AS envoi_accuse_reception,\n    \"Date d'envoi de l'AR\" AS date_envoi_ar,\n    \"Pr\u00e9cisions sur le non envoi de l'AR\" AS precisions_non_envoi_ar,\n    \"Date de transfert \u00e0 l'institution comp\u00e9tente\" AS date_transfert_institution_competente,\n    \"Date de prise en charge par le service gestionnaire\" AS date_prise_en_charge_service_gestionnaire,\n    \"Type de traitement\" AS type_traitement,\n    \"Pr\u00e9cisions sur le type de traitement\" AS precisions_type_traitement,\n    \"R\u00e9clamation en lien avec un ou plusieurs signalements\" AS reclamation_lien_signalements,\n    \"Num\u00e9ro(s) de signalement(s) associ\u00e9(s)\" AS numeros_signalements_associes,\n    \"Date d'examen en commission\" AS date_examen_commission,\n    \"Type d'action\" AS type_action,\n    \"Mesures prises par le mis en cause\" AS mesures_mis_en_cause,\n    \"Mesures \u00e0 l'initiative de\" AS mesures_a_initiative,\n    \"R\u00e9ponse au requ\u00e9rant par l'ARS\" AS reponse_requerant_ars,\n    \"Date de r\u00e9ponse au requ\u00e9rant\" AS date_reponse_requerant,\n    \"Pr\u00e9cisions sur la r\u00e9ponse au requ\u00e9rant\" AS precisions_reponse_requerant,\n    \"Date de r\u00e9ponse  \u00e0 l'institution de provenance\" AS date_reponse_institution_provenance,\n    \"Motif de cl\u00f4ture\" AS motif_cloture,\n    Commentaire AS commentaire,\n    \"Date de cl\u00f4ture\" AS date_cloture,\n    \"Si\u00e8ge ARS\" AS siege_ars,\n    \"Motifs d\u00e9clar\u00e9s\" AS motifs_declares\nFROM sirec\nWHERE LENGTH(CAST(\"N\u00b0 FINESS/RPPS\" AS VARCHAR)) IN (8, 9)\nAND \"Date de r\u00e9ception \u00e0 l\u2019ARS\" < '2024-12-31'", "relation_name": "\"duckdb_database\".\"main\".\"staging__matrice_sirec\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:50.902079Z", "completed_at": "2025-04-02T14:55:50.902079Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:50.902079Z", "completed_at": "2025-04-02T14:55:50.932299Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03121495246887207, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__sirec_input_test", "compiled": true, "compiled_code": "\n\nWITH sirec AS (\n    SELECT \n        \"Num\u00e9ro de la r\u00e9clamation\" AS numero_reclamation,\n        \"Date de r\u00e9ception \u00e0 l\u2019ARS\" AS date_reception_ars,\n        CAST(\"N\u00b0 FINESS/RPPS\" AS VARCHAR) AS numero_finess_rpps\n    FROM \"duckdb_database\".\"main\".\"staging__sa_sirec\"\n)\n\nSELECT \n    COUNT(*) AS nombre_de_lignes,\n    COUNT(DISTINCT numero_reclamation) AS nombre_distinct_reclamations,\n    SUM(CASE WHEN LENGTH(numero_finess_rpps) = 8 THEN 1 ELSE 0 END) AS longueur_ko_finess,\n    SUM(CASE WHEN LENGTH(numero_finess_rpps) = 9 THEN 1 ELSE 0 END) AS longueur_ok_finess,\n    MIN(date_reception_ars) AS date_reelle_visite_plus_ancienne,\n    MAX(date_reception_ars) AS date_reelle_visite_plus_recente,\n    MIN(SUBSTRING(date_reception_ars, 1, 4)) AS annee_min,\n    MIN(SUBSTRING(date_reception_ars, 6, 2)) AS mois_min,\n    MAX(SUBSTRING(date_reception_ars, 1, 4)) AS annee_max,\n    MAX(SUBSTRING(date_reception_ars, 6, 2)) AS mois_max\nFROM sirec", "relation_name": "\"duckdb_database\".\"main\".\"staging__sirec_input_test\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:50.936238Z", "completed_at": "2025-04-02T14:55:50.940089Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:50.940089Z", "completed_at": "2025-04-02T14:55:50.964920Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029188156127929688, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__helios_sivss", "compiled": true, "compiled_code": "\n\nWITH sivss AS (\n    SELECT \n        structure_intitule,\n        numero_sivss,\n        SUBSTRING(date_reception, 7, 4) || '-' || \n        SUBSTRING(date_reception, 4, 2) || '-' || \n        SUBSTRING(date_reception, 1, 2) AS date_reception,\n        famille_principale,\n        nature_principale,\n        autre_signal_libelle,\n        famille_secondaire,\n        nature_secondaire,\n        autre_signal_secondaire_libelle,\n        est_eigs,\n        consequences_personne_exposee,\n        reclamation,\n        declarant_est_anonyme,\n        declarant_qualite_fonction,\n        declarant_categorie,\n        declarant_organisme_type,\n        declarant_etablissement_type,\n        declarant_organisme_numero_finess,\n        declarant_organisme_nom,\n        declarant_organisme_region,\n        declarant_organisme_departement,\n        declarant_organisme_code_postal,\n        declarant_organisme_commune,\n        declarant_organisme_code_insee,\n        survenue_cas_collectivite,\n        scc_organisme_type,\n        scc_etablissement_type,\n        scc_organisme_nom,\n        scc_organisme_finess,\n        scc_organisme_region,\n        scc_organisme_departement,\n        scc_organisme_code_postal,\n        scc_organisme_commune,\n        scc_organisme_code_insee,\n        etat,\n        support_signalement,\n        SUBSTRING(date_cloture, 7, 4) || '-' || \n        SUBSTRING(date_cloture, 4, 2) || '-' || \n        SUBSTRING(date_cloture, 1, 2) AS date_cloture,\n        motif_cloture\n    FROM \"duckdb_database\".\"main\".\"staging__sa_sivss\"\n    WHERE (SUBSTRING(date_cloture, 7, 4) || SUBSTRING(date_cloture, 4, 2)) <= '202412'\n)\n\nSELECT * FROM sivss", "relation_name": "\"duckdb_database\".\"main\".\"staging__helios_sivss\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:50.969914Z", "completed_at": "2025-04-02T14:55:50.973939Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:50.975358Z", "completed_at": "2025-04-02T14:55:51.001977Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0335695743560791, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__tdb_ic_finess_500", "compiled": true, "compiled_code": "\n\nWITH finess_500 AS (\n    SELECT \n        finess,\n        rs,\n        CASE \n            WHEN LENGTH(com_code) = 4 THEN '0' || com_code \n            ELSE com_code \n        END AS com_code,\n        statut_jur_niv2_code,\n        statut_jur_niv2_lib,\n        etat\n    FROM \"duckdb_database\".\"main\".\"staging__sa_t_finess\"\n    WHERE categ_code = 500\n    AND etat = 'ACTUEL'\n)\n\nSELECT * FROM finess_500", "relation_name": "\"duckdb_database\".\"main\".\"staging__tdb_ic_finess_500\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:51.001977Z", "completed_at": "2025-04-02T14:55:51.009885Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:51.010991Z", "completed_at": "2025-04-02T14:55:51.034392Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03241539001464844, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__cert_dc_finess", "compiled": true, "compiled_code": "\n\nWITH finess AS (\n    SELECT \n        finess,\n        finess8,\n        etat,\n        date_extract_finess,\n        rs,\n        type,\n        ej_finess,\n        ej_rs,\n        et_finess,\n        et_rs,\n        siren,\n        siret,\n        date_autorisation,\n        date_ouverture,\n        date_maj_finess,\n        adresse_num_voie,\n        adresse_comp_voie,\n        adresse_type_voie,\n        adresse_nom_voie,\n        adresse_lieuditbp,\n        adresse_code_postal,\n        adresse_lib_routage,\n        telephone,\n        telecopie,\n        CASE \n            WHEN LENGTH(com_code) = 4 THEN '0' || com_code \n            ELSE com_code \n        END AS com_code,        statut_jur_code,\n        statut_jur_lib,\n        statut_jur_etat,\n        statut_jur_niv3_code,\n        statut_jur_niv3_lib,\n        statut_jur_niv2_code,\n        statut_jur_niv2_lib,\n        statut_jur_niv1_code,\n        statut_jur_niv1_lib,\n        CAST(categ_code AS INTEGER) AS categ_code,\n        categ_lib,\n        categ_lib_court,\n        categ_etat,\n        categ_niv3_code,\n        categ_niv3_lib,\n        categ_niv2_code,\n        categ_niv2_lib,\n        categ_niv1_code,\n        categ_niv1_lib,\n        categ_domaine,\n        esms,\n        esms_capaTot_inst,\n        esms_capaInternat_inst,\n        esms_esh,\n        esms_ash,\n        esms_pa,\n        san,\n        san_med,\n        san_chir,\n        san_obs,\n        san_psy,\n        san_sld,\n        san_urg,\n        san_dialyse,\n        san_cancer,\n        nb_scanners,\n        nb_irm,\n        gestion_ars,\n        gestion_dreets,\n        gestion_drihl,\n        version_nomenclature,\n        tutelle,\n        mft_code,\n        mft_lib,\n        sph_code,\n        sph_lib,\n        geoloc_source,\n        geoloc_precision,\n        geoloc_legal_x,\n        geoloc_legal_y,\n        geoloc_legal_projection,\n        geoloc_3857_x,\n        geoloc_3857_y,\n        geoloc_4326_long,\n        geoloc_4326_lat\n    FROM \"duckdb_database\".\"main\".\"staging__sa_t_finess\"\n)\n\nSELECT \n    finess.*, \n    c.libelle AS commune_libelle,\n    d.libelle AS departement_libelle\nFROM finess\nLEFT JOIN \"duckdb_database\".\"main\".\"staging__v_commune\" c ON finess.com_code = c.com\nLEFT JOIN \"duckdb_database\".\"main\".\"staging__v_departement\" d ON SUBSTRING(finess.com_code, 1, 2) = d.dep", "relation_name": "\"duckdb_database\".\"main\".\"staging__cert_dc_finess\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:51.038441Z", "completed_at": "2025-04-02T14:55:51.042966Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:51.042966Z", "completed_at": "2025-04-02T14:55:51.066887Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029482126235961914, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__ref_departements", "compiled": true, "compiled_code": "\n\nWITH departements AS (\n    -- D\u00e9partements m\u00e9tropolitains\n    SELECT\n        DEP AS dep,\n        REG AS reg,\n        NCC AS ncc,\n        LIBELLE AS libelle\n    FROM \"duckdb_database\".\"main\".\"staging__v_departement\" \n\n    UNION\n\n    -- D\u00e9partements des DROM via v_comer\n    SELECT\n        COMER AS dep,\n        COMER AS reg,\n        NCC AS ncc,\n        LIBELLE AS libelle\n    FROM \"duckdb_database\".\"main\".\"staging__v_comer\"\n)\n\nSELECT * FROM departements", "relation_name": "\"duckdb_database\".\"main\".\"staging__ref_departements\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:51.070171Z", "completed_at": "2025-04-02T14:55:51.075351Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:51.076360Z", "completed_at": "2025-04-02T14:55:51.100330Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03015899658203125, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__dgcs_query", "compiled": true, "compiled_code": "\n\nWITH finess AS (\n    SELECT \n        finess,\n        com_code,\n        categ_code,\n        categ_lib,\n        etat\n    FROM \"duckdb_database\".\"main\".\"staging__sa_t_finess\"\n    WHERE categ_code IN (\n        448, 402, 396, 395, 370, 437, 255, 246, 198, 249, 238, 390, 188, 377, \n        192, 183, 186, 195, 194, 196, 379, 445, 221, 190, 189, 182\n    )\n), geo AS (\n    SELECT \n        c.com AS commune_code,  -- Adapte ici si le nom est diff\u00e9rent\n        c.libelle AS commune_libelle,\n        d.dep AS departement_code,\n        d.libelle AS departement_libelle,\n        r.reg AS region_code,\n        r.libelle AS region_libelle\n    FROM \"duckdb_database\".\"main\".\"staging__v_commune\" c\n    LEFT JOIN \"duckdb_database\".\"main\".\"staging__v_departement\" d ON c.dep = d.dep\n    LEFT JOIN \"duckdb_database\".\"main\".\"staging__v_region\" r ON d.reg = r.reg\n)\n\nSELECT \n    finess.*,\n    geo.region_code,\n    geo.region_libelle,\n    geo.departement_code,\n    geo.departement_libelle,\n    geo.commune_libelle\nFROM finess\nLEFT JOIN geo ON finess.com_code = geo.commune_code", "relation_name": "\"duckdb_database\".\"main\".\"staging__dgcs_query\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:51.103429Z", "completed_at": "2025-04-02T14:55:51.103429Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:51.103429Z", "completed_at": "2025-04-02T14:55:51.128452Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.025022268295288086, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__ref_regions", "compiled": true, "compiled_code": "\n\nWITH regions AS (\n    SELECT\n        REG AS reg,\n        NCC AS ncc,\n        LIBELLE AS libelle\n    FROM \"duckdb_database\".\"main\".\"staging__v_region\"\n\n    UNION\n\n    SELECT\n        COMER AS reg,\n        NCC AS ncc,\n        LIBELLE AS libelle\n    FROM \"duckdb_database\".\"main\".\"staging__v_comer\" \n)\n\nSELECT * FROM regions", "relation_name": "\"duckdb_database\".\"main\".\"staging__ref_regions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:51.133771Z", "completed_at": "2025-04-02T14:55:51.137798Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:51.137798Z", "completed_at": "2025-04-02T14:55:51.168639Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03486776351928711, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtHelios.helios__missions", "compiled": true, "compiled_code": "with all_inspections as (\n\n    select\n        missions.\"Identifiant de la mission\",\n        missions.\"Code th\u00e8me IGAS\",\n        missions.\"Th\u00e8me IGAS\",\n        missions.\"Code Th\u00e8me r\u00e9gional\",\n        missions.\"Th\u00e8me r\u00e9gional\",\n        missions.\"Type de mission\",\n        missions.\"Type de planification\",\n        missions.\"Modalit\u00e9 de la mission\",\n\n        case \n            when length(missions.\"Code FINESS\") = 8 then '0' || missions.\"Code FINESS\"\n            else missions.\"Code FINESS\"\n        end as \"Code FINESS\",\n\n        missions.\"Date r\u00e9elle \"\"Visite\"\"\" as \"Date r\u00e9elle Visite\",\n        missions.\"Date r\u00e9elle \"\"Rapport\"\"\" as \"Date r\u00e9elle Rapport\",\n        missions.\"Nombre d\u00e9carts\",\n        missions.\"Nombre de remarques\",\n        missions.Injonction,\n        missions.Prescription,\n        missions.Recommandation,\n        missions.\"Saisine CNG\",\n        missions.\"Saisine juridiction/ordinale\",\n        missions.\"Saisine parquet\",\n        missions.\"Autre saisine\",\n        missions.\"Statut de la mission\",\n\n        decisions.\"Type_de_decision\",\n        decisions.Complement,\n        decisions.\"Theme_Decision\",\n        decisions.\"Sous_theme_Decision\",\n        decisions.Nombre,\n        decisions.\"Statut_de_decision\",\n        case \n            when length(decisions.\"Identifiant_FINESS_geographique\") = 8 then '0' || decisions.\"Identifiant_FINESS_geographique\"\n            else decisions.\"Identifiant_FINESS_geographique\"\n        end as \"Identifiant_FINESS_geographique\",\n        case \n            when length(decisions.\"Identifiant_FINESS_de_rattachement\") = 8 then '0' || decisions.\"Identifiant_FINESS_de_rattachement\"\n            else decisions.\"Identifiant_FINESS_de_rattachement\"\n        end as \"Identifiant_FINESS_de_rattachement\",\n        decisions.\"Date_de_realisation\",\n        decisions.\"Etat_davancement\"\n\n    from \"duckdb_database\".\"main\".\"staging__helios_siicea_missions\" as missions\n\n    left join \"duckdb_database\".\"main\".\"staging__sa_siicea_suites\" as decisions\n        on missions.\"Identifiant de la mission\" = decisions.\"Identifiant_de_la_mission\"\n\n    where missions.\"Code FINESS\" != ''\n)\n\nselect distinct\n    \"Identifiant de la mission\",\n    \"Code th\u00e8me IGAS\",\n    \"Th\u00e8me IGAS\",\n    \"Code Th\u00e8me r\u00e9gional\",\n    \"Th\u00e8me r\u00e9gional\",\n    \"Type de mission\",\n    \"Type de planification\",\n    \"Modalit\u00e9 de la mission\",\n    \"Code FINESS\",\n    substr(\"Date r\u00e9elle Visite\", 1, 10) as \"Date r\u00e9elle Visite\",\n    substr(\"Date r\u00e9elle Rapport\", 1, 10) as \"Date r\u00e9elle Rapport\",\n    \"Nombre d\u00e9carts\",\n    \"Nombre de remarques\",\n    Injonction,\n    Prescription,\n    Recommandation,\n    \"Saisine CNG\",\n    \"Saisine juridiction/ordinale\",\n    \"Saisine parquet\",\n    \"Autre saisine\",\n    \"Statut de la mission\"\n\nfrom all_inspections", "relation_name": "\"duckdb_database\".\"main\".\"helios__missions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:51.170232Z", "completed_at": "2025-04-02T14:55:51.177374Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:51.178295Z", "completed_at": "2025-04-02T14:55:51.220173Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.049941301345825195, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtHelios.helios__sirec", "compiled": true, "compiled_code": "-- Mod\u00e8le DBT corrig\u00e9 pour helios__sirec avec construction de \"Motifs IGAS\"\n\nwith base as (\n    select\n        cast(\"N\u00b0 FINESS/RPPS\" as varchar) as \"N\u00b0 FINESS/RPPS\",\n        cast(\"N\u00b0 FINESS/RPPS\" as varchar) || substr(\"Date de r\u00e9ception \u00e0 l\u2019ARS\", 1, 4) as IDENTIFIANT,\n        substr(\"Date de r\u00e9ception \u00e0 l\u2019ARS\", 1, 4) as ANNEE_DE_RECEPTION,\n        \"Num\u00e9ro de la r\u00e9clamation\",\n        case\n            when \"Motifs IGAS sortie\" is not null and trim(\"Motifs IGAS sortie\") != '' then \"Motifs IGAS sortie\"\n            else \"Motifs IGAS entr\u00e9e\"\n        end as \"Motifs IGAS\",\n        case\n            when \"Statut de la r\u00e9clamation\" in ('Affectation', 'R\u00e9ponse', 'Traitement') then 'en cours'\n            when \"Statut de la r\u00e9clamation\" = 'Cl\u00f4ture' then 'clot'\n        end as STATUT_AGREG\n    from \"duckdb_database\".\"main\".\"staging__helios_sirec\"\n    where length(cast(\"N\u00b0 FINESS/RPPS\" as varchar)) > 4 and length(cast(\"N\u00b0 FINESS/RPPS\" as varchar)) <= 9\n),\n\nmotifs_split as (\n    select\n        b.IDENTIFIANT,\n        b.\"N\u00b0 FINESS/RPPS\",\n        b.ANNEE_DE_RECEPTION,\n        b.\"Num\u00e9ro de la r\u00e9clamation\",\n        b.STATUT_AGREG,\n        trim(motif_value) as MOTIFS_IGAS_SPLIT\n    from base b,\n         unnest(string_split(\"Motifs IGAS\", '|')) as motif(motif_value)\n),\n\nmotifs_classified as (\n    select\n        IDENTIFIANT,\n        \"N\u00b0 FINESS/RPPS\",\n        ANNEE_DE_RECEPTION,\n        STATUT_AGREG,\n        \"Num\u00e9ro de la r\u00e9clamation\",\n        case when MOTIFS_IGAS_SPLIT like '%H\u00f4tellerie-locaux-restauration%' then '10'\n             when MOTIFS_IGAS_SPLIT like '%organisation ou de fonctionnement%' then '11'\n             when MOTIFS_IGAS_SPLIT like '%qualit\u00e9 des soins m\u00e9dicaux%' then '12'\n             when MOTIFS_IGAS_SPLIT like '%qualit\u00e9 des soins param\u00e9dicaux%' then '13'\n             when MOTIFS_IGAS_SPLIT like '%\u00e9tablissement ou d%un professionnel%' then '14'\n             when MOTIFS_IGAS_SPLIT like '%attitude des professionnels%' then '15'\n             when MOTIFS_IGAS_SPLIT like '%droits des usagers%' then '16'\n             when MOTIFS_IGAS_SPLIT like '%Facturation et honoraires%' then '17'\n             when MOTIFS_IGAS_SPLIT like '%Sant\u00e9-environnementale%' then '18'\n             when MOTIFS_IGAS_SPLIT like '%esth\u00e9tique r\u00e9glement\u00e9es%' then '19'\n             when MOTIFS_IGAS_SPLIT like '%A renseigner%' then '155'\n             when MOTIFS_IGAS_SPLIT like '%COVID-19%' then '156'\n             else null end as code_motif\n    from motifs_split\n),\n\nagreg_motif as (\n    select\n        IDENTIFIANT,\n        \"N\u00b0 FINESS/RPPS\",\n        ANNEE_DE_RECEPTION,\n        STATUT_AGREG,\n        code_motif,\n        count(distinct \"Num\u00e9ro de la r\u00e9clamation\") as NB_RECLAMATIONS\n    from motifs_classified\n    where code_motif is not null\n    group by all\n),\n\npivoted as (\n    select\n        IDENTIFIANT,\n        \"N\u00b0 FINESS/RPPS\",\n        ANNEE_DE_RECEPTION,\n\n        max(case when STATUT_AGREG = 'en cours' then NB_RECLAMATIONS end) as ENCOURS_NB_RECLA_TOTAL,\n        max(case when STATUT_AGREG = 'clot' then NB_RECLAMATIONS end) as CLOT_NB_RECLA_TOTAL,\n\n        max(case when code_motif = '10' and STATUT_AGREG = 'en cours' then NB_RECLAMATIONS end) as ENCOURS_NB_RECLA_MOTIF_10,\n        max(case when code_motif = '11' and STATUT_AGREG = 'en cours' then NB_RECLAMATIONS end) as ENCOURS_NB_RECLA_MOTIF_11,\n        max(case when code_motif = '12' and STATUT_AGREG = 'en cours' then NB_RECLAMATIONS end) as ENCOURS_NB_RECLA_MOTIF_12,\n        max(case when code_motif = '13' and STATUT_AGREG = 'en cours' then NB_RECLAMATIONS end) as ENCOURS_NB_RECLA_MOTIF_13,\n        max(case when code_motif = '14' and STATUT_AGREG = 'en cours' then NB_RECLAMATIONS end) as ENCOURS_NB_RECLA_MOTIF_14,\n        max(case when code_motif = '15' and STATUT_AGREG = 'en cours' then NB_RECLAMATIONS end) as ENCOURS_NB_RECLA_MOTIF_15,\n        max(case when code_motif = '16' and STATUT_AGREG = 'en cours' then NB_RECLAMATIONS end) as ENCOURS_NB_RECLA_MOTIF_16,\n        max(case when code_motif = '17' and STATUT_AGREG = 'en cours' then NB_RECLAMATIONS end) as ENCOURS_NB_RECLA_MOTIF_17,\n        max(case when code_motif = '18' and STATUT_AGREG = 'en cours' then NB_RECLAMATIONS end) as ENCOURS_NB_RECLA_MOTIF_18,\n        max(case when code_motif = '19' and STATUT_AGREG = 'en cours' then NB_RECLAMATIONS end) as ENCOURS_NB_RECLA_MOTIF_19,\n        max(case when code_motif = '155' and STATUT_AGREG = 'en cours' then NB_RECLAMATIONS end) as ENCOURS_NB_RECLA_MOTIF_155,\n        max(case when code_motif = '156' and STATUT_AGREG = 'en cours' then NB_RECLAMATIONS end) as ENCOURS_NB_RECLA_MOTIF_156,\n\n        max(case when code_motif = '10' and STATUT_AGREG = 'clot' then NB_RECLAMATIONS end) as CLOT_NB_RECLA_MOTIF_10,\n        max(case when code_motif = '11' and STATUT_AGREG = 'clot' then NB_RECLAMATIONS end) as CLOT_NB_RECLA_MOTIF_11,\n        max(case when code_motif = '12' and STATUT_AGREG = 'clot' then NB_RECLAMATIONS end) as CLOT_NB_RECLA_MOTIF_12,\n        max(case when code_motif = '13' and STATUT_AGREG = 'clot' then NB_RECLAMATIONS end) as CLOT_NB_RECLA_MOTIF_13,\n        max(case when code_motif = '14' and STATUT_AGREG = 'clot' then NB_RECLAMATIONS end) as CLOT_NB_RECLA_MOTIF_14,\n        max(case when code_motif = '15' and STATUT_AGREG = 'clot' then NB_RECLAMATIONS end) as CLOT_NB_RECLA_MOTIF_15,\n        max(case when code_motif = '16' and STATUT_AGREG = 'clot' then NB_RECLAMATIONS end) as CLOT_NB_RECLA_MOTIF_16,\n        max(case when code_motif = '17' and STATUT_AGREG = 'clot' then NB_RECLAMATIONS end) as CLOT_NB_RECLA_MOTIF_17,\n        max(case when code_motif = '18' and STATUT_AGREG = 'clot' then NB_RECLAMATIONS end) as CLOT_NB_RECLA_MOTIF_18,\n        max(case when code_motif = '19' and STATUT_AGREG = 'clot' then NB_RECLAMATIONS end) as CLOT_NB_RECLA_MOTIF_19,\n        max(case when code_motif = '155' and STATUT_AGREG = 'clot' then NB_RECLAMATIONS end) as CLOT_NB_RECLA_MOTIF_155,\n        max(case when code_motif = '156' and STATUT_AGREG = 'clot' then NB_RECLAMATIONS end) as CLOT_NB_RECLA_MOTIF_156\n    from agreg_motif\n    group by IDENTIFIANT, \"N\u00b0 FINESS/RPPS\", ANNEE_DE_RECEPTION\n)\n\nselect\n    IDENTIFIANT,\n    case when length(cast(\"N\u00b0 FINESS/RPPS\" as varchar)) = 8 then '0' || \"N\u00b0 FINESS/RPPS\" else \"N\u00b0 FINESS/RPPS\" end as NDEG_FINESS_RPPS,\n    ANNEE_DE_RECEPTION,\n    ENCOURS_NB_RECLA_TOTAL,\n    ENCOURS_NB_RECLA_MOTIF_10,\n    ENCOURS_NB_RECLA_MOTIF_11,\n    ENCOURS_NB_RECLA_MOTIF_12,\n    ENCOURS_NB_RECLA_MOTIF_13,\n    ENCOURS_NB_RECLA_MOTIF_14,\n    ENCOURS_NB_RECLA_MOTIF_15,\n    ENCOURS_NB_RECLA_MOTIF_16,\n    ENCOURS_NB_RECLA_MOTIF_17,\n    ENCOURS_NB_RECLA_MOTIF_18,\n    ENCOURS_NB_RECLA_MOTIF_19,\n    ENCOURS_NB_RECLA_MOTIF_155,\n    ENCOURS_NB_RECLA_MOTIF_156,\n    CLOT_NB_RECLA_TOTAL,\n    CLOT_NB_RECLA_MOTIF_10,\n    CLOT_NB_RECLA_MOTIF_11,\n    CLOT_NB_RECLA_MOTIF_12,\n    CLOT_NB_RECLA_MOTIF_13,\n    CLOT_NB_RECLA_MOTIF_14,\n    CLOT_NB_RECLA_MOTIF_15,\n    CLOT_NB_RECLA_MOTIF_16,\n    CLOT_NB_RECLA_MOTIF_17,\n    CLOT_NB_RECLA_MOTIF_18,\n    CLOT_NB_RECLA_MOTIF_19,\n    CLOT_NB_RECLA_MOTIF_155,\n    CLOT_NB_RECLA_MOTIF_156\nfrom pivoted", "relation_name": "\"duckdb_database\".\"main\".\"helios__sirec\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:51.220173Z", "completed_at": "2025-04-02T14:55:51.225813Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:51.229835Z", "completed_at": "2025-04-02T14:55:51.250442Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03026890754699707, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtHelios.helios_sivss", "compiled": true, "compiled_code": "-- Mod\u00e8le DBT pour la vue sivss_to_helios\n\nselect\n    STRUCTURE_INTITULE,\n    NUMERO_SIVSS,\n    DATE_RECEPTION,\n    FAMILLE_PRINCIPALE,\n    NATURE_PRINCIPALE,\n    AUTRE_SIGNAL_LIBELLE,\n    FAMILLE_SECONDAIRE,\n    NATURE_SECONDAIRE,\n    AUTRE_SIGNAL_SECONDAIRE_LIBELLE,\n    EST_EIGS,\n    CONSEQUENCES_PERSONNE_EXPOSEE,\n    RECLAMATION,\n    DECLARANT_EST_ANONYME,\n    DECLARANT_QUALITE_FONCTION,\n    DECLARANT_CATEGORIE,\n    DECLARANT_ORGANISME_TYPE,\n    DECLARANT_ETABLISSEMENT_TYPE,\n    DECLARANT_ORGANISME_NUMERO_FINESS,\n    DECLARANT_ORGANISME_NOM,\n    DECLARANT_ORGANISME_REGION,\n    DECLARANT_ORGANISME_DEPARTEMENT,\n    DECLARANT_ORGANISME_CODE_POSTAL,\n    DECLARANT_ORGANISME_COMMUNE,\n    DECLARANT_ORGANISME_CODE_INSEE,\n    SURVENUE_CAS_COLLECTIVITE,\n    SCC_ORGANISME_TYPE,\n    SCC_ETABLISSEMENT_TYPE,\n    SCC_ORGANISME_NOM,\n    SCC_ORGANISME_FINESS,\n    SCC_ORGANISME_REGION,\n    SCC_ORGANISME_DEPARTEMENT,\n    SCC_ORGANISME_CODE_POSTAL,\n    SCC_ORGANISME_COMMUNE,\n    SCC_ORGANISME_CODE_INSEE,\n    ETAT,\n    SUPPORT_SIGNALEMENT,\n    DATE_CLOTURE,\n    MOTIF_CLOTURE\nfrom \"duckdb_database\".\"main\".\"staging__helios_sivss\"\nwhere\n    length(DATE_CLOTURE) <= 10\n    and (\n        DATE_CLOTURE = '--'\n        or substr(DATE_CLOTURE, 1, 4) in ('2022', '2023', '2024')\n    )", "relation_name": "\"duckdb_database\".\"main\".\"helios_sivss\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:51.255912Z", "completed_at": "2025-04-02T14:55:51.261538Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:51.261538Z", "completed_at": "2025-04-02T14:55:51.285312Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029400110244750977, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__ref_communes", "compiled": true, "compiled_code": "\n\nWITH all_com AS (\n    -- Communes actuelles\n    SELECT \n        COM AS com,\n        REG AS reg,\n        DEP AS dep,\n        NCC AS ncc, \n        LIBELLE AS libelle\n    FROM \"duckdb_database\".\"main\".\"staging__v_commune\" \n    WHERE REG != ''\n\n    UNION \n\n    -- Communes des DROM\n    SELECT\n        COM_COMER AS com,\n        COMER AS reg,\n        COMER AS dep,\n        NCC AS ncc, \n        LIBELLE AS libelle\n    FROM \"duckdb_database\".\"main\".\"staging__v_commune_comer\" \n\n    UNION\n\n    -- Communes historiques\n    SELECT \n        vcd.COM AS com,\n        rd.reg AS reg,\n        CASE \n            WHEN CAST(vcd.COM AS INTEGER) >= 97000 THEN SUBSTRING(vcd.COM, 1, 3)\n            ELSE SUBSTRING(vcd.COM, 1, 2)\n        END AS dep,\n        vcd.NCC AS ncc, \n        vcd.LIBELLE AS libelle\n    FROM \"duckdb_database\".\"main\".\"staging__v_commune_depuis\" vcd \n    LEFT JOIN \"duckdb_database\".\"main\".\"staging__ref_departements\" rd \n        ON (CASE \n                WHEN CAST(vcd.COM AS INTEGER) >= 97000 THEN SUBSTRING(vcd.COM, 1, 3)\n                ELSE SUBSTRING(vcd.COM, 1, 2)\n            END) = rd.dep\n)\n\n-- Suppression des doublons\nSELECT DISTINCT * FROM all_com", "relation_name": "\"duckdb_database\".\"main\".\"staging__ref_communes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-02T14:55:51.291816Z", "completed_at": "2025-04-02T14:55:51.297803Z"}, {"name": "execute", "started_at": "2025-04-02T14:55:51.297803Z", "completed_at": "2025-04-02T14:55:51.320352Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030253887176513672, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbtStaging.staging__ref_geo", "compiled": true, "compiled_code": "\n\nWITH geo AS (\n    SELECT\n        rc.com AS com_cd,\n        rc.libelle AS com_lb,\n        rd.dep AS dep_cd,\n        rd.libelle AS dep_lb,\n        rr.reg AS reg_cd,\n        rr.libelle AS reg_lb\n    FROM \"duckdb_database\".\"main\".\"staging__ref_communes\" rc\n    LEFT JOIN \"duckdb_database\".\"main\".\"staging__ref_departements\" rd\n        ON rc.dep = rd.dep\n    LEFT JOIN \"duckdb_database\".\"main\".\"staging__ref_regions\" rr\n        ON rd.reg = rr.reg\n)\n\nSELECT * FROM geo", "relation_name": "\"duckdb_database\".\"main\".\"staging__ref_geo\"", "batch_results": null}], "elapsed_time": 6.979710102081299, "args": {"vars": {}, "require_resource_names_without_spaces": false, "static_parser": true, "require_nested_cumulative_type_params": false, "show_resource_report": false, "which": "run", "defer": false, "empty": false, "log_level": "info", "printer_width": 80, "quiet": false, "cache_selected_only": false, "state_modified_compare_more_unrendered_values": false, "partial_parse": true, "skip_nodes_if_on_run_start_fails": false, "log_format_file": "debug", "log_level_file": "debug", "invocation_command": "dbt run", "print": true, "partial_parse_file_diff": true, "select": [], "project_dir": "C:\\Users\\TitouanHOUDE\\Documents\\DNUM\\Helios\\dbtHelios", "log_path": "C:\\Users\\TitouanHOUDE\\Documents\\DNUM\\Helios\\dbtHelios\\logs", "require_batched_execution_for_custom_microbatch_strategy": false, "state_modified_compare_vars": false, "log_file_max_bytes": 10485760, "strict_mode": false, "introspect": true, "profiles_dir": "C:\\Users\\TitouanHOUDE\\.dbt", "require_yaml_configuration_for_mf_time_spines": false, "macro_debugging": false, "version_check": true, "send_anonymous_usage_stats": true, "indirect_selection": "eager", "write_json": true, "use_colors": true, "exclude": [], "log_format": "default", "source_freshness_run_project_hooks": false, "warn_error_options": {"include": [], "exclude": []}, "populate_cache": true, "use_colors_file": true, "favor_state": false, "require_explicit_package_overrides_for_builtin_materializations": true}}